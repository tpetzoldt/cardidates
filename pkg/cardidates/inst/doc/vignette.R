###################################################
### chunk number 1: 
###################################################
x <- c(0, 19, 38, 57, 76, 95, 114, 133, 152, 170, 190, 208, 227, 246, 265,
      284, 303, 322, 341, 360)
y <- c(0.9, 1, 1.2, 1, 2, 4, 7, 3, 4, 2, 1.1, 1, 1, 1, 0.9, 1.2, 1,
       0.8, 1.1, 1)


###################################################
### chunk number 2: 
###################################################
plot(x, y)


###################################################
### chunk number 3: 
###################################################
library(cardidates)
res <- fitweibull6(x, y)


###################################################
### chunk number 4: 
###################################################
summary(res)


###################################################
### chunk number 5: 
###################################################
plot(res)


###################################################
### chunk number 6: 
###################################################
set.seed(537)
x <- seq(1, 360, length=50)
y <- exp(cos(x/20)) + 0.3+ rnorm(x, sd=0.3)


###################################################
### chunk number 7: 
###################################################
peaks <- peakwindow(x, y, xstart=60)


###################################################
### chunk number 8: 
###################################################
plot(x, y, type = "l", ylim = c(0, 5))
smd <- peaks$smd.indices
lines(x[smd], y[smd], col="red", lwd=2)
text(x, y, peaks$peakid, col = peaks$peakid %% 2 + 2, pos=3)


###################################################
### chunk number 9: 
###################################################
res <- fitweibull6(x[smd], y[smd])
summary(res)


###################################################
### chunk number 10: 
###################################################
plot(res, ylim=c(0,4), xlim=c(0,360))
points(x, y, pch="+", type="b")


###################################################
### chunk number 11: 
###################################################
CDW(res, symmetric=FALSE)


###################################################
### chunk number 12: 
###################################################
CDW(res, quantile=0.01, symmetric=FALSE)


